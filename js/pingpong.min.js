class PingPongGame{constructor(){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.canvas.id="ping-pong-canvas",this.canvas.style.position="fixed",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.zIndex="-5",this.canvas.style.pointerEvents="none",this.canvas.style.opacity="0.3",document.body.insertBefore(this.canvas,document.body.firstChild),this.paddleHeight=this.canvas.height/8,this.paddleWidth=15,this.paddleSpeed=8,this.leftPaddle={x:10,y:this.canvas.height/2-this.paddleHeight/2,width:this.paddleWidth,height:this.paddleHeight,dy:0,score:0},this.rightPaddle={x:this.canvas.width-this.paddleWidth-10,y:this.canvas.height/2-this.paddleHeight/2,width:this.paddleWidth,height:this.paddleHeight,dy:0,score:0},this.ballSize=10,this.ballTrail=[],this.trailLength=5,this.resetBall(),this.paused=!1,this.update=this.update.bind(this),this.draw=this.draw.bind(this),this.resize=this.resize.bind(this),window.addEventListener("resize",this.resize),this.updateColors(),this.lastTime=performance.now(),this.start()}updateColors(){"dark"===document.body.getAttribute("data-theme")?(this.backgroundColor="rgba(34, 38, 57, 0)",this.paddleColor="rgba(126, 87, 194, 0.9)",this.ballColor="rgba(255, 221, 0, 0.9)",this.trailColor="rgba(255, 221, 0, 0.4)"):(this.backgroundColor="rgba(240, 240, 240, 0)",this.paddleColor="rgba(93, 52, 175, 0.9)",this.ballColor="rgba(255, 204, 0, 0.9)",this.trailColor="rgba(255, 204, 0, 0.4)")}resetBall(){this.ballTrail=[],this.ball={x:this.canvas.width/2,y:this.canvas.height/2,dx:5*(Math.random()>.5?1:-1),dy:5*Math.random()-2.5,size:this.ballSize};const t=Math.sqrt(this.ball.dx*this.ball.dx+this.ball.dy*this.ball.dy);this.ball.dx=this.ball.dx/t*5,this.ball.dy=this.ball.dy/t*5}moveAIPaddles(){const t=this.leftPaddle.y+this.leftPaddle.height/2,i=(this.ball.y,this.leftPaddle.height,20*Math.random()-10);this.ball.y+i<t-30?this.leftPaddle.dy=-this.paddleSpeed:this.ball.y+i>t+30?this.leftPaddle.dy=this.paddleSpeed:this.leftPaddle.dy=0;const h=this.rightPaddle.y+this.rightPaddle.height/2,s=(this.ball.y,this.rightPaddle.height,20*Math.random()-10);this.ball.y+s<h-30?this.rightPaddle.dy=-this.paddleSpeed:this.ball.y+s>h+30?this.rightPaddle.dy=this.paddleSpeed:this.rightPaddle.dy=0,this.leftPaddle.y+=this.leftPaddle.dy,this.rightPaddle.y+=this.rightPaddle.dy,this.leftPaddle.y<0?this.leftPaddle.y=0:this.leftPaddle.y+this.leftPaddle.height>this.canvas.height&&(this.leftPaddle.y=this.canvas.height-this.leftPaddle.height),this.rightPaddle.y<0?this.rightPaddle.y=0:this.rightPaddle.y+this.rightPaddle.height>this.canvas.height&&(this.rightPaddle.y=this.canvas.height-this.rightPaddle.height)}checkCollisions(){if((this.ball.y-this.ball.size<0||this.ball.y+this.ball.size>this.canvas.height)&&(this.ball.dy=-this.ball.dy,this.ball.y-this.ball.size<0?this.ball.y=this.ball.size:this.ball.y=this.canvas.height-this.ball.size),this.ball.x-this.ball.size<this.leftPaddle.x+this.leftPaddle.width&&this.ball.x+this.ball.size>this.leftPaddle.x&&this.ball.y>this.leftPaddle.y&&this.ball.y<this.leftPaddle.y+this.leftPaddle.height){this.ball.dx=Math.abs(this.ball.dx);const t=(this.leftPaddle.y+this.leftPaddle.height/2-this.ball.y)/(this.leftPaddle.height/2);this.ball.dy=5*-t,this.ball.x=this.leftPaddle.x+this.leftPaddle.width+this.ball.size}if(this.ball.x+this.ball.size>this.rightPaddle.x&&this.ball.x-this.ball.size<this.rightPaddle.x+this.rightPaddle.width&&this.ball.y>this.rightPaddle.y&&this.ball.y<this.rightPaddle.y+this.rightPaddle.height){this.ball.dx=-Math.abs(this.ball.dx);const t=(this.rightPaddle.y+this.rightPaddle.height/2-this.ball.y)/(this.rightPaddle.height/2);this.ball.dy=5*-t,this.ball.x=this.rightPaddle.x-this.ball.size}this.ball.x-this.ball.size<0?(this.rightPaddle.score++,this.resetBall()):this.ball.x+this.ball.size>this.canvas.width&&(this.leftPaddle.score++,this.resetBall())}update(t){this.lastTime;if(this.lastTime=t,!this.paused){for(this.ballTrail.push({x:this.ball.x,y:this.ball.y});this.ballTrail.length>this.trailLength;)this.ballTrail.shift();this.ball.x+=this.ball.dx,this.ball.y+=this.ball.dy,this.moveAIPaddles(),this.checkCollisions()}}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath(),this.ctx.setLineDash([10,15]),this.ctx.moveTo(this.canvas.width/2,0),this.ctx.lineTo(this.canvas.width/2,this.canvas.height),this.ctx.strokeStyle=this.paddleColor,this.ctx.lineWidth=2,this.ctx.stroke(),this.ctx.setLineDash([]);for(let t=0;t<this.ballTrail.length;t++){const i=this.ballTrail[t],h=t/this.ballTrail.length,s=this.ball.size*(.5+.5*h);this.ctx.fillStyle=this.trailColor,this.ctx.beginPath(),this.ctx.arc(i.x,i.y,s,0,2*Math.PI),this.ctx.fill()}this.ctx.fillStyle=this.ballColor,this.ctx.beginPath(),this.ctx.arc(this.ball.x,this.ball.y,this.ball.size,0,2*Math.PI),this.ctx.fill(),this.ctx.fillStyle=this.paddleColor,this.ctx.fillRect(this.leftPaddle.x,this.leftPaddle.y,this.leftPaddle.width,this.leftPaddle.height),this.ctx.fillRect(this.rightPaddle.x,this.rightPaddle.y,this.rightPaddle.width,this.rightPaddle.height)}gameLoop(t){this.update(t),this.draw(),requestAnimationFrame(this.gameLoop.bind(this))}start(){this.paused=!1,this.gameLoop(performance.now())}pause(){this.paused=!0}resume(){this.paused&&(this.paused=!1,this.lastTime=performance.now(),this.gameLoop(this.lastTime))}resize(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.paddleHeight=this.canvas.height/8,this.leftPaddle.height=this.paddleHeight,this.leftPaddle.y=this.canvas.height/2-this.paddleHeight/2,this.leftPaddle.x=10,this.rightPaddle.height=this.paddleHeight,this.rightPaddle.x=this.canvas.width-this.paddleWidth-10,this.rightPaddle.y=this.canvas.height/2-this.paddleHeight/2,this.ball.x>this.canvas.width&&(this.ball.x=this.canvas.width/2),this.ball.y>this.canvas.height&&(this.ball.y=this.canvas.height/2),this.ballTrail=[]}destroy(){window.removeEventListener("resize",this.resize),this.canvas.remove()}}document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{const t=new PingPongGame,i=document.getElementById("toggle-theme");i&&i.addEventListener("click",()=>{setTimeout(()=>{t.updateColors()},50)}),window.pingPong=t},500)});